<section id="updates" class="section alt" data-animate>
  <div class="section-title">
    <p class="eyebrow">Updates</p>
    <h2>News and deadlines</h2>
  </div>
  {% assign published_updates = site.data.updates | where_exp: "u", "u.publish == true" %}
  {% if published_updates.size == 0 %}
    <div class="callout">
      <h3>No announcements yet</h3>
      <p>We will post confirmed updates here as they are announced.</p>
    </div>
  {% elsif include.mode == "summary" %}
    <div class="updates-list">
      {% for item in published_updates limit: 2 %}
        <div class="update-item">
          <span class="update-date">{{ item.date | date: "%b %-d, %Y" }}</span>
          <div>
            <strong>{{ item.title }}</strong>
            <p>{{ item.description }}</p>
          </div>
        </div>
      {% endfor %}
    </div>
    <div class="updates-actions">
      <a class="btn ghost" href="{{ '/updates/' | relative_url }}">View all updates</a>
    </div>
  {% else %}
    <div class="grid updates">
      {% for item in published_updates %}
        <article class="update-card">
          <span class="update-date">{{ item.date | date: "%b %-d, %Y" }}</span>
          <h3>{{ item.title }}</h3>
          <p>{{ item.description }}</p>
          {% if item.link and item.link.href %}
            {% assign href = item.link.href %}
            {% if href contains "http://" or href contains "https://" or href contains "mailto:" %}
              <a class="btn ghost" href="{{ href }}" target="_blank" rel="noopener">{{ item.link.label }}</a>
            {% else %}
              <a class="btn ghost" href="{{ href | relative_url }}">{{ item.link.label }}</a>
            {% endif %}
          {% endif %}
        </article>
      {% endfor %}
    </div>
  {% endif %}
</section>
